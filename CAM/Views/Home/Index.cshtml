@model HomeIndexViewModel

@{
    ViewBag.Title = "Home Page";
}

@section subhead
{
    @if (Model.HasSite())
    {
        <h1>CA&ES Computer Account Request</h1>
        
        <p>Please select a CA&ES Dean's Office workgroup that the new user will be apart of.  If more than one, please select the primary workgroup.  If available select from a template based on their job title.</p>
    }
}

@if (!Model.HasSite())
{
    <ul>
        @foreach(var site in Model.Sites)
        {
            <li>
                @Html.ActionLink(site.Name, "Index", new {@site=site.Id})
            </li>    
        }
    </ul>
}
else
{
    <div class="tile-menu">
        <div class="row">
            <a href="#" class="span4 btn-success tile">
                <i class="icon-plus-sign-alt icon-4x"></i>
                <h3>Create Request</h3>
            </a>
            <a href="#" class="span4 btn-info tile">
                <i class="icon-reorder icon-4x"></i>
                <h3>View Status</h3>
            </a>
            <a href="#" class="span4 btn-danger tile">
                <i class="icon-minus-sign icon-4x"></i>
                <h3>Close Account</h3>
            </a>
        </div>
    </div>
    
    <section>
        
        <table class="table">
        <thead>
            <tr>
                <th></th>
                <th>Name</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var unit in Model.Units)
            {
                <tr>
                    <td><input type="button" class="btn selectUnit" value="Select" data-id="@unit.Id" /></td>
                    <td>@unit.Name</td>
                    <td>@unit.Description</td>
                </tr>
            }
        </tbody>
    </table>

    </section>
    
    <section>
        
        <ul id="templates" class="unstyled" style="display:none;">
        </ul>

    </section>
}

@section AdditionalScripts
{
@*    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.tmpl.min.js")"></script>

    <script type="text/javascript">

        var loadUrl = '@Url.Action("LoadTemplates")';

        $(function () {
            $(".selectUnit").click(function () {

                var $container = $("#templates");
                $container.empty();
                $container.hide();
                
                $.get(loadUrl, { unitId: $(this).data('id') }, function(result) {
                    $("#templateTemplate").tmpl(result).appendTo($container);
                    $container.show('normal');
                });
                
            });
        });
    </script>

    <script id="templateTemplate" type="text/x-jquery-tmpl">
        <li>
            <a href='@Url.Action("Create", "Request")/${Id}' class="btn btn-success">
                Select
            </a>
            ${Name}
        </li>
    </script>
    
    <style type="text/css">
    #templates li
    {
        margin: 1em 0;
    }
    </style>*@

}
